`try_merge` needs some serious f*cking work done to it.
so does `merge_all`.

Honestly everything in `optimiser` is insanity but at least the loop optimisations seem to be sane.